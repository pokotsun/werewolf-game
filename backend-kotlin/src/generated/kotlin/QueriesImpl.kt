// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.25.0

package com.example.generated

import java.sql.Connection
import java.sql.SQLException
import java.time.LocalDateTime
import java.util.UUID

const val getUser = """-- name: getUser :one
SELECT user_id, name, updated_at FROM "user"
        WHERE user_id = ? LIMIT 1
"""

const val getVillages = """-- name: getVillages :many
SELECT id, name, user_counts, created_at, updated_at FROM "village"
"""

class QueriesImpl(private val conn: Connection) : Queries {

  @Throws(SQLException::class)
  override fun getUser(userId: UUID): User? {
    return conn.prepareStatement(getUser).use { stmt ->
      stmt.setObject(1, userId)

      val results = stmt.executeQuery()
      if (!results.next()) {
        return null
      }
      val ret = User(
                results.getObject(1) as UUID,
                results.getString(2),
                results.getObject(3, LocalDateTime::class.java)
            )
      if (results.next()) {
          throw SQLException("expected one row in result set, but got many")
      }
      ret
    }
  }

  @Throws(SQLException::class)
  override fun getVillages(): List<Village> {
    return conn.prepareStatement(getVillages).use { stmt ->
      
      val results = stmt.executeQuery()
      val ret = mutableListOf<Village>()
      while (results.next()) {
          ret.add(Village(
                results.getObject(1) as UUID,
                results.getString(2),
                results.getBigDecimal(3),
                results.getObject(4, LocalDateTime::class.java),
                results.getObject(5, LocalDateTime::class.java)
            ))
      }
      ret
    }
  }

}

